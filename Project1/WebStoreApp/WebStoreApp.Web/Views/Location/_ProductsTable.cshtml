@model WebStoreApp.Web.Models.LocationViewModel
<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Products[0].Name)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Products[0].Price)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Products[0].Quantity)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
    @foreach (var product in Model.Products)
    {
        var deleteId = $"btn-delete-{product.Id.ToString()}";
        <tr>
            <td>
                @Html.DisplayFor(modelItem => product.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => product.Price)
            </td>
            <td>
                @Html.DisplayFor(modelItem => product.Quantity)
            </td>
            <td>
                <form method="POST" asp-action="Delete" style="display: inline-block;">
                    <input type="hidden" asp-for="Id" />
                    <input type="hidden" asp-for="ProductId" value="@product.Id" />
                    <input type="submit" value="Delete" class="btn">
                </form> | 
                <button id="btn-edit-@product.Id"class="btn" >Edit</button>
            </td>
        </tr>
    }
    </tbody>
</table>
<div id="edit-modal" class="modal">
    <div class="modal-content">
        <form method="POST" asp-action="Edit">
            <input type="hidden" asp-for="Id" />
            <input type="hidden" id="edit-product-id" asp-for="ProductId" />
            <div class="form-group">
                <label asp-for="ProductName" class="control-label"></label>
                <input asp-for="ProductName" id="edit-product-name" class="form-control">
                <span asp-validation-for="ProductName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="ProductPrice" class="control-label"></label>
                <input asp-for="ProductPrice" id="edit-product-price" class="form-control">
                <span asp-validation-for="ProductPrice" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="ProductQuantity" class="control-label"></label>
                <input asp-for="ProductQuantity" id="edit-product-quantity" class="form-control">
                <span asp-validation-for="ProductQuantity" class="text-danger"></span>
            </div>
            <input type="submit" value="Edit" class="btn btn-primary" /> 
        </form>
    </div>
</div>

<script>
    const products = JSON.parse('@Html.Raw(Json.Serialize(Model.Products))');
    products.forEach(product => {
        document.getElementById("btn-edit-" + product.id).addEventListener("click", () =>
        {
            document.getElementById("edit-product-name").value = product.name;
            document.getElementById("edit-product-price").value = product.price;
            document.getElementById("edit-product-quantity").value = product.quantity;
            document.getElementById("edit-product-id").value = product.id;
            document.getElementById("edit-modal").style.display = "block";
        });
    });
    window.addEventListener("click", (event) => {
        if(event.target == document.getElementById("edit-modal")) {
            document.getElementById("edit-modal").style.display = "none";
        }
    });
</script>

